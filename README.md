## ğŸ“š é¡¹ç›®æ–‡æ¡£

æœ¬é¡¹ç›®é‡‡ç”¨æ¨¡å—åŒ–æ–‡æ¡£ç»“æ„ï¼Œè¯¦ç»†å†…å®¹è¯·å‚è€ƒwikiç›®å½•ï¼š

| æ¨¡å— | å†…å®¹æ¦‚è¿° | ç›®æ ‡ç”¨æˆ· |
|------|----------|----------|
| [01-é¡¹ç›®æ¦‚è¿°ä¸å¿«é€Ÿå…¥é—¨](wiki/01-é¡¹ç›®æ¦‚è¿°ä¸å¿«é€Ÿå…¥é—¨.md) | é¡¹ç›®ä»‹ç»ã€å®‰è£…é…ç½®ã€åŸºç¡€ä½¿ç”¨ | æ‰€æœ‰ç”¨æˆ· |
| [02-æ ¸å¿ƒæ¶æ„è®¾è®¡](wiki/02-æ ¸å¿ƒæ¶æ„è®¾è®¡.md) | ç³»ç»Ÿæ¶æ„ã€äº‹ä»¶æ€»çº¿ã€è°ƒåº¦å™¨ã€è¾“å…¥ç³»ç»Ÿ | å¼€å‘è€… |
| [03-åŠŸèƒ½æ¨¡å—è¯¦è§£](wiki/03-åŠŸèƒ½æ¨¡å—è¯¦è§£.md) | æŠ€èƒ½ç³»ç»Ÿã€è¯å‰‚ç®¡ç†ã€è£…å¤‡æ´—ç»ƒã€è‡ªåŠ¨å¯»è·¯ | é«˜çº§ç”¨æˆ· |
| [04-é…ç½®ä¸æ¡ä»¶ç³»ç»Ÿ](wiki/04-é…ç½®ä¸æ¡ä»¶ç³»ç»Ÿ.md) | é…ç½®ç®¡ç†ã€æ¡ä»¶é€»è¾‘ã€çƒ­é‡è½½æœºåˆ¶ | é…ç½®äººå‘˜ |
| [05-å›¾åƒæ•è·ä¸æ€§èƒ½](wiki/05-å›¾åƒæ•è·ä¸æ€§èƒ½.md) | DXGIæ•è·ã€æ¨¡æ¿åŒ¹é…ã€æ€§èƒ½ä¼˜åŒ– | æŠ€æœ¯äººå‘˜ |
| [06-è°ƒè¯•ä¸å¼€å‘](wiki/06-è°ƒè¯•ä¸å¼€å‘.md) | è°ƒè¯•å·¥å…·ã€å¼€å‘ç¯å¢ƒã€æµ‹è¯•æ¡†æ¶ | å¼€å‘è€… |
| [07-éƒ¨ç½²ä¸è¿ç»´](wiki/07-éƒ¨ç½²ä¸è¿ç»´.md) | ç¯å¢ƒéƒ¨ç½²ã€ç›‘æ§å‘Šè­¦ã€æ•…éšœæ¢å¤ | è¿ç»´äººå‘˜ |
| [08-æ•…éšœæ’æŸ¥æ‰‹å†Œ](wiki/08-æ•…éšœæ’æŸ¥æ‰‹å†Œ.md) | å¸¸è§é—®é¢˜ã€è¯Šæ–­å·¥å…·ã€è§£å†³æ–¹æ¡ˆ | æ”¯æŒäººå‘˜ |
| [09-APIå‚è€ƒä¸æ‰©å±•](wiki/09-APIå‚è€ƒä¸æ‰©å±•.md) | APIæ¥å£ã€æ’ä»¶å¼€å‘ã€æ‰©å±•æŒ‡å— | æ‰©å±•å¼€å‘è€… |
| [10-å¤šçº§ä¼˜å…ˆçº§ç³»ç»Ÿ](wiki/10-å¤šçº§ä¼˜å…ˆçº§ç³»ç»Ÿ.md) | å››çº§ä¼˜å…ˆé˜Ÿåˆ—ã€æŒ‰é”®ç›‘æ§ã€æŠ€èƒ½è¿‡æ»¤ | é«˜çº§ç”¨æˆ· |


## é¡¹ç›®å…¥å£

pyahkæä¾›ä¸¤ç§ä½¿ç”¨æ–¹å¼ï¼š

1. **GUIç‰ˆæœ¬** (`main.py`)ï¼šå®Œæ•´çš„å›¾å½¢ç”¨æˆ·ç•Œé¢ï¼Œæ”¯æŒæ‰€æœ‰åŠŸèƒ½æ¨¡å—çš„å¯è§†åŒ–é…ç½®å’Œæ§åˆ¶
2. **å‘½ä»¤è¡Œç‰ˆæœ¬** (`main_special.py`)ï¼šè½»é‡çº§ç‰ˆæœ¬ï¼Œä¸“æ³¨äºç‰¹å®šæ¸¸æˆåœºæ™¯çš„è‡ªåŠ¨åŒ–ä»»åŠ¡

## æ ¸å¿ƒåŠŸèƒ½ç‰¹æ€§

- **é›¶æ‹·è´å±å¹•æ•è·æŠ€æœ¯**: åŸºäºDXGI Desktop Duplication APIçš„C++å®ç°ï¼Œä½¿ç”¨åŒç¼“å†²åŒºå’ŒåŸå­æŒ‡é’ˆæŠ€æœ¯å®ç°çœŸæ­£çš„é›¶æ‹·è´ï¼Œç¡®ä¿æ¯«ç§’çº§å“åº”é€Ÿåº¦ã€‚
- **äº‹ä»¶é©±åŠ¨æ¶æ„**: æ ¸å¿ƒç»„ä»¶é€šè¿‡ä¸­å¤®äº‹ä»¶æ€»çº¿(EventBus)é€šä¿¡ï¼Œæ”¯æŒå¼‚æ­¥å‘å¸ƒ/è®¢é˜…æ¨¡å¼ï¼Œå®ç°å®Œå…¨è§£è€¦å’Œé€’å½’äº‹ä»¶æ£€æµ‹ã€‚
- **ç»Ÿä¸€è°ƒåº¦å™¨**: åŸºäºheapqå’Œmonotonicæ—¶é—´æºçš„å•çº¿ç¨‹è°ƒåº¦å™¨ï¼Œé¿å…ç³»ç»Ÿæ—¶é’Ÿè°ƒæ•´å½±å“ï¼Œæä¾›äºšæ¯«ç§’çº§å®šæ—¶ç²¾åº¦ã€‚
- **ä¼˜å…ˆçº§æŒ‰é”®æš‚åœ/æ¢å¤æœºåˆ¶**: é€šè¿‡å…¨å±€æŒ‰é”®ç›‘å¬ï¼Œåœ¨ç”¨æˆ·æŒ‰ä½è‡ªå®šä¹‰çš„ä¼˜å…ˆçº§æŒ‰é”®ï¼ˆå¦‚ç©ºæ ¼ã€å³é”®ï¼‰æ—¶ï¼Œèƒ½æ™ºèƒ½åœ°æš‚åœæ‰€æœ‰åå°è°ƒåº¦ä»»åŠ¡ï¼ˆæŠ€èƒ½å†·å´ã€èµ„æºæ£€æµ‹ç­‰ï¼‰ï¼Œåœ¨æŒ‰é”®é‡Šæ”¾åè‡ªåŠ¨æ¢å¤ã€‚æ­¤æœºåˆ¶å®ç°äº†çœŸæ­£çš„â€œæŒ‰éœ€è®¡ç®—â€ï¼Œåœ¨æ‰‹åŠ¨æ“ä½œæœŸé—´å¯èŠ‚çœ70-90%çš„CPUèµ„æºã€‚
- **æ™ºèƒ½è¯å‰‚ç®¡ç†**: 
    - **è‡ªåŠ¨åœ†å½¢æ ¡å‡†**: ç”¨æˆ·åªéœ€ç‚¹å‡»ä¸€ä¸‹æŒ‰é’®ï¼Œç¨‹åºå³å¯é€šè¿‡éœå¤«åœ†å˜æ¢ç®—æ³•ï¼Œè‡ªåŠ¨è¯†åˆ«æ¸¸æˆä¸­çš„è¡€é‡/è“é‡çƒä½“ï¼Œå¹¶ç²¾ç¡®è®¡ç®—å‡ºå…¶åœ†å¿ƒå’ŒåŠå¾„ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®åæ ‡ã€‚
    - **åŠåœ†åˆ†æç®—æ³•**: åœ¨è®¡ç®—è¯å‰‚ç™¾åˆ†æ¯”æ—¶ï¼Œæ™ºèƒ½åœ°åªåˆ†æçƒä½“æœªè¢«UIé®æŒ¡çš„ä¸€åŠï¼ˆå¦‚è¡€çƒçš„å³åŠåœ†ï¼Œè“çƒçš„å·¦åŠåœ†ï¼‰ï¼Œä»æ ¹æœ¬ä¸Šæ’é™¤äº†UIè¾¹æ¡†çš„å¹²æ‰°ã€‚
    - **ç»Ÿä¸€HSVæ¨¡æ¿åŒ¹é…**: æ‰€æœ‰èµ„æºæ£€æµ‹å‡é‡‡ç”¨æ›´é²æ£’çš„HSVé¢œè‰²ç©ºé—´è¿›è¡Œæ¨¡æ¿åŒ¹é…ã€‚
- **é«˜çº§æŠ€èƒ½ç³»ç»Ÿ**: 
    - **ç»Ÿä¸€HSVå†·å´æ£€æµ‹**: æ‰€æœ‰æŠ€èƒ½çš„å†·å´æ£€æµ‹éƒ½å·²å‡çº§ä¸ºHSVæ¨¡æ¿åŒ¹é…ï¼Œèƒ½æœ‰æ•ˆæŠµæŠ—æ¸¸æˆå†…å…‰ç…§å’ŒæŠ€èƒ½å›¾æ ‡åŠ¨ç”»æ•ˆæœçš„å¹²æ‰°ï¼Œè¯†åˆ«æ›´ç²¾å‡†ã€‚
    - **å¤šè§¦å‘æ¨¡å¼**: æ”¯æŒå®šæ—¶ã€å†·å´ã€æŒ‰ä½(Hold)ç­‰å¤šç§è§¦å‘æ¨¡å¼ã€‚
    - **åŒé‡ä¼˜å…ˆçº§**: æ”¯æŒæ£€æŸ¥ä¼˜å…ˆçº§ï¼ˆä¼˜å…ˆæ£€æµ‹ï¼‰å’Œé˜Ÿåˆ—ä¼˜å…ˆçº§ï¼ˆæ’é˜Ÿæ‰§è¡Œï¼‰ï¼Œç¡®ä¿æ ¸å¿ƒæŠ€èƒ½çš„å“åº”é€Ÿåº¦ã€‚
- **è£…å¤‡è¯ç¼€æ´—ç»ƒ**: åŸºäºSimpleAffixRerollManagerçš„é…ç½®é©±åŠ¨æ´—ç»ƒï¼Œé›†æˆPaddleOCRè¯ç¼€è¯†åˆ«å’Œå®æ—¶OSDåé¦ˆã€‚
- **è‡ªåŠ¨å¯»è·¯ä¸æ¢ç´¢**: é‡‡ç”¨ç›¸ä½ç›¸å…³ä½ç§»è·Ÿè¸ªå’ŒA*ç®—æ³•ï¼Œå®ç°éšæœºåœ°å›¾çš„è‡ªä¸»æ¢ç´¢å’Œç²¾ç¡®è·¯å¾„è§„åˆ’ã€‚
- **çŠ¶æ€æœºç®¡ç†**: ä¸¥æ ¼çš„å››çŠ¶æ€è½¬æ¢æœºåˆ¶(STOPPEDâ†’READYâ†’RUNNINGâ†’PAUSED)å’Œæ¨¡å¼äº’æ–¥é€»è¾‘ã€‚
- **è°ƒè¯•ä¸ç›‘æ§**: é›†æˆDebugDisplayManageræä¾›å®æ—¶OSDå’Œæ¡ä»¶æ—¥å¿—è¾“å‡ºã€‚

## ä½¿ç”¨æ–¹æ³•

1.  **å¯åŠ¨ç¨‹åº**:
    *   **GUIç‰ˆæœ¬**: è¿è¡Œ `main.py`ï¼Œå¯åŠ¨åŒ…å«å®Œæ•´PySide6ç•Œé¢çš„ç‰ˆæœ¬ï¼Œæ”¯æŒæ‰€æœ‰åŠŸèƒ½æ¨¡å—ã€‚
    *   **ç‰¹æ®Šç‰ˆæœ¬**: è¿è¡Œ `main_special.py`ï¼Œå¯åŠ¨ä¸“ç”¨äºç‰¹å®šè‡ªåŠ¨åŒ–åœºæ™¯çš„ç‹¬ç«‹è„šæœ¬(Zé”®æ§åˆ¶è‡ªåŠ¨å·¦é”®)ã€‚

2.  **é…ç½®**: åœ¨GUIä¸­å®Œæˆé…ç½®ï¼Œæ”¯æŒJSONæ ¼å¼çš„é…ç½®æ–‡ä»¶åŠ è½½/ä¿å­˜ï¼Œé…ç½®é€šè¿‡ConfigManagerç»Ÿä¸€ç®¡ç†ã€‚

3.  **çƒ­é”®æ“ä½œ**:
    *   **F8 (ä¸»æ§é”®)**: åœ¨STOPPEDå’ŒREADYçŠ¶æ€é—´åˆ‡æ¢ï¼Œå‡†å¤‡æŠ€èƒ½æ¨¡å¼æ‰§è¡Œã€‚
    *   **F7 (æ´—ç»ƒé”®)**: ç‹¬ç«‹æ§åˆ¶è£…å¤‡è¯ç¼€æ´—ç»ƒæ¨¡å¼çš„å¯åŠ¨/åœæ­¢ã€‚
    *   **F9 (å¯»è·¯é”®)**: ç‹¬ç«‹æ§åˆ¶è‡ªåŠ¨å¯»è·¯æ¨¡å¼çš„å‡†å¤‡/åœæ­¢ã€‚
    *   **Z (æ‰§è¡Œ/æš‚åœé”®)**: åœ¨READYçŠ¶æ€ä¸‹å¯åŠ¨æ‰§è¡Œ(RUNNING)ï¼Œåœ¨RUNNINGçŠ¶æ€ä¸‹æš‚åœ/æ¢å¤(PAUSED)ã€‚

4.  **é¢œè‰²é…ç½®æ ¼å¼**: æ–°ç‰ˆæœ¬æ”¯æŒæ›´æ¸…æ™°çš„å¤šè¡Œé¢œè‰²é…ç½®æ ¼å¼ï¼š
    ```
    å®¹å·®å€¼(H,S,V)     # ç¬¬ä¸€è¡Œï¼šå…¨å±€å®¹å·®è®¾ç½®
    é¢œè‰²1(H,S,V)      # ç¬¬äºŒè¡Œï¼šç¬¬ä¸€ç§æ£€æµ‹é¢œè‰²
    é¢œè‰²2(H,S,V)      # ç¬¬ä¸‰è¡Œï¼šç¬¬äºŒç§æ£€æµ‹é¢œè‰²ï¼ˆå¯é€‰ï¼‰
    ...               # æ›´å¤šé¢œè‰²ï¼ˆå¯é€‰ï¼‰
    ```
    
    **ç¤ºä¾‹é…ç½®**ï¼š
    - **HPè¡€é‡æ£€æµ‹**ï¼š
      ```
      10,20,20        # å®¹å·®ï¼šHÂ±10, SÂ±20, VÂ±20
      157,75,29       # çº¢è‰²è¡€é‡
      40,84,48        # ç»¿è‰²è¡€é‡ï¼ˆå¤‡ç”¨ï¼‰
      ```
    
    - **MPé­”åŠ›æ£€æµ‹**ï¼š
      ```
      5,5,5           # å®¹å·®ï¼šHÂ±5, SÂ±5, VÂ±5
      104,80,58       # è“è‰²é­”åŠ›
      ```

## ä¾èµ–ç¯å¢ƒä¸é…ç½®

### ç³»ç»Ÿè¦æ±‚
- **æ“ä½œç³»ç»Ÿ**: Windows 10/11
- **Pythonç‰ˆæœ¬**: 3.7+

### æ ¸å¿ƒä¾èµ–
```
PySide6>=6.5.0        # GUIæ¡†æ¶
psutil>=5.9.0         # ç³»ç»Ÿè¿›ç¨‹ç›‘æ§
pynput>=1.7.6         # é”®ç›˜é¼ æ ‡è¾“å…¥æ§åˆ¶
Pillow>=9.0.0         # å›¾åƒå¤„ç†
mss>=9.0.1           # é«˜æ€§èƒ½æˆªå›¾(å¤‡ç”¨)
numpy>=1.20.0         # æ•°å€¼è®¡ç®—
opencv-python>=4.5.0  # è®¡ç®—æœºè§†è§‰
pywin32>=306          # Windows API
paddleocr==2.7.3      # OCRæ–‡å­—è¯†åˆ«(å›ºå®šç‰ˆæœ¬)
```

### é¡¹ç›®ç»“æ„
```
torchlight_assistant/
â”œâ”€â”€ core/                           # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ macro_engine.py            # ä¸»æ§åˆ¶å™¨å’ŒçŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ event_bus.py               # äº‹ä»¶æ€»çº¿
â”‚   â”œâ”€â”€ unified_scheduler.py       # ç»Ÿä¸€è°ƒåº¦å™¨
â”‚   â”œâ”€â”€ input_handler.py           # è¾“å…¥å¤„ç†å™¨
â”‚   â”œâ”€â”€ skill_manager.py           # æŠ€èƒ½ç®¡ç†
â”‚   â”œâ”€â”€ resource_manager.py        # èµ„æºæ£€æµ‹
â”‚   â”œâ”€â”€ debug_display_manager.py   # è°ƒè¯•æ˜¾ç¤º
â”‚   â”œâ”€â”€ simple_affix_reroll_manager.py # è£…å¤‡æ´—ç»ƒ
â”‚   â”œâ”€â”€ pathfinding_manager.py     # è‡ªåŠ¨å¯»è·¯
â”‚   â””â”€â”€ states.py                  # çŠ¶æ€æšä¸¾
â”œâ”€â”€ gui/                           # ç”¨æˆ·ç•Œé¢
â”‚   â”œâ”€â”€ main_window.py             # ä¸»çª—å£
â”‚   â”œâ”€â”€ debug_osd_window.py        # è°ƒè¯•è¦†ç›–çª—å£
â”‚   â””â”€â”€ ...
â”œâ”€â”€ utils/                         # å·¥å…·ç±»
â”‚   â”œâ”€â”€ multi_priority_queue.py    # å¤šçº§ä¼˜å…ˆé˜Ÿåˆ—
â”‚   â”œâ”€â”€ priority_deque.py          # ä¼˜å…ˆçº§é˜Ÿåˆ—(å…¼å®¹)
â”‚   â”œâ”€â”€ native_graphics_capture_manager.py # å›¾å½¢æ•è·
â”‚   â”œâ”€â”€ border_frame_manager.py    # è¾¹æ¡†ç®¡ç†
â”‚   â”œâ”€â”€ hotkey_manager.py          # çƒ­é”®ç®¡ç†
â”‚   â””â”€â”€ ...
â””â”€â”€ native_capture/                # C++åŸç”Ÿæ•è·åº“
    â”œâ”€â”€ capture_lib.cpp            # DXGIæ•è·å®ç°
    â”œâ”€â”€ capture_lib.h              # Cæ¥å£å®šä¹‰
    â”œâ”€â”€ python_wrapper.py          # PythonåŒ…è£…å™¨
    â””â”€â”€ ...
```