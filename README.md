## pyahk Wiki 索引

> 本仓库 README 仅保留文档索引。所有说明、架构、使用与调试内容请直接查看 `wiki/` 目录对应文件。

| # | 文档 | 描述 |
|--|------|------|
| 01 | 01-项目概述 | 总览与核心理念 |
| 02 | 02-技能系统 | 触发模式 / 优先级 / 序列 / Hold |
| 03 | 03-智能药剂 | HSV 双检测 / 三层委托架构 |
| 04 | 04-装备洗练 | OCR 词缀识别与三状态逻辑 |
| 05 | 05-自动寻路 | 地图拼接 / Z 字形探索 / A* |
| 06 | 06-架构设计 | 模块职责与交互图 |
| 07 | 07-配置指南 | 配置字段、热键、条件、药剂 |
| 08 | 08-开发指南 | 启动流程 / 调度 / 扩展点 |
| 09 | 09-调试模式 | Debug OSD / 发布策略 |
| 10 | 10-输入系统 | 队列 / 优先级 / Hold / dry_run |
| 11 | 11-图像与性能 | 捕获 / 模板 / 优化策略 |
| 12 | 12-条件系统 | ExecuteCondition / 连续窗口 |
| 13 | 13-FAQ | 常见问题与排查 |

License: MIT


## 项目入口

pyahk提供两种使用方式：

1. **GUI版本** (`main.py`)：完整的图形用户界面，支持所有功能模块的可视化配置和控制
2. **命令行版本** (`main_special.py`)：轻量级版本，专注于特定游戏场景的自动化任务

## 核心功能特性

- **零拷贝屏幕捕获技术**: 利用现代Windows Graphics Capture API和C++底层实现，确保毫秒级响应速度。
- **事件驱动架构**: 核心组件通过中央事件总线(EventBus)通信，实现完全解耦。
- **统一调度器**: 基于heapq的单线程调度器，管理所有定时任务，降低资源开销并提高计时精度。
- **智能药剂管理**: 采用HSV双色检测算法，支持正常/中毒状态智能识别和精确的资源检测。
- **装备词缀洗练**: 独立的F7热键控制模块，通过PaddleOCR进行词缀识别，支持实时OSD反馈。
- **自动寻路与探索**: 采用相位相关位移跟踪和A*算法，实现随机地图的自主探索和精确路径规划。
- **模式互斥逻辑**: 严格区分"技能模式"、"洗练模式"和"寻路模式"，确保逻辑清晰、行为可预测。
- **高级技能系统**: 支持定时、冷却、按住(Hold)等多种触发模式，并集成了优先级系统。
- **音频反馈系统**: 为核心操作提供即时声音提示。

## 使用方法

1.  **启动程序**:
    *   **完整版本**: 运行 `main.py`，启动包含完整GUI界面的版本。
    *   **简化版本**: 运行 `main_special.py`，启动命令行版本。

2.  **配置**: 在GUI中完成您的配置，支持加载/保存JSON格式的配置文件。

3.  **热键操作**:
    *   **F8 (主控键)**: 准备/停止**技能模式**。
    *   **F7 (洗练键)**: 启动/停止**装备洗练模式**。
    *   **F9 (寻路键)**: 准备/停止**自动寻路模式**。
    *   **Z (执行/暂停键)**: 在"准备"状态下，开始执行任务；在"运行"状态下，暂停/恢复任务。

## 依赖环境与配置

### 系统要求
- **操作系统**: Windows 10/11
- **Python版本**: 3.7+

### 核心依赖
```
PySide6>=6.5.0
psutil>=5.9.0
pynput>=1.7.6
Pillow>=9.0.0
numpy>=1.20.0
opencv-python>=4.5.0
pywin32>=306
paddleocr==2.7.3
```

### 项目结构
```
torchlight_assistant/
├── core/                    # 核心业务逻辑
│   ├── macro_engine.py     # 主控制器
│   ├── skill_manager.py    # 技能管理
│   └── ...
├── gui/                    # 用户界面
│   ├── main_window.py      # 主窗口
│   └── ...
├── utils/                  # 工具类
│   └── ...
└── native_capture/         # C++原生捕获库
    ├── capture_lib.cpp
    └── ...
```